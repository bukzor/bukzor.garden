# V0 Milestones Devlog

Ongoing log for Super Tic-Tac-Toe V0 development.

---

## 2026-02-03: Board Rendering

**Focus:** Basic 3x3 board rendering as foundation.

**Completed:**
- Board rendering with CSS Grid (3x3 grid, classic # lines)
- Restructured milestones: basic 3x3 first, then super-ify
- ADR for HTML+CSS rendering decision
- Clean separation: CSS in `style.css`, HTML generation in Rust
- Cell struct with position awareness and render method
- Data attributes (`data-row`, `data-col`) for CSS targeting

**Discovered:**
- CSS gap+background has subpixel issues at 1-2px; borders more reliable
- Inline `?` can confuse type inference with deref coercion; explicit bindings help
- Trunk `data-trunk` directives must stay in HTML (build-time)

**Decisions:**
- HTML+CSS over Canvas — see `docs/dev/adr/2026-02-03-000-htmlcss-rendering-for-super-tic-tac-toe.md`
- Start with basic 3x3, super-ify later

**Next:** Input handling (click/touch to place X/O)

---

## 2026-02-03 (cont'd): Ownership Simplification

**Conventions established:**

- **`&mut self` over functional style** — Functional (`fn method(self) -> Self`) forces `mem::replace` hacks to extract ownership from `RefCell`. Not worth it without undo/redo or snapshots.

- **Extract incidental complexity** — Helpers let you see the logic without the ceremony. Review test: does implementation detail match intent detail?

- **Don't store derivable data** — Data that duplicates its container's structure can lie (a `Square` at `[0][1]` claiming row 2). Delete it.

**Next:** Win detection

---

## 2026-02-04: Win Detection

**Focus:** Complete 3x3 tic-tac-toe with win/draw detection.

**Completed:**
- `Outcome` enum (InProgress, Win(Mark), Draw) with Debug derive
- Const-generated `WINNING_LINES` array via `winning_lines()` const fn
- `check_winner()` checks all 8 lines, `is_full()` detects draws
- `play()` updated: early-exit if game ended, set outcome, clear `current_turn` to Empty
- Status element above board shows "X wins!" / "O wins!" / "Draw!"
- CSS for status with `min-height` to prevent layout shift

**Decisions:**
- Const fn over literal array for winning lines — easier to verify correctness (pattern vs 24 coordinates)
- `current_turn = Mark::Empty` after game ends — semantically honest ("no one's turn")
- Direct field access for `outcome` instead of getter — no abstraction until earned
- Status element passed to click handler (option 1 from plan review)

**Next:** Super-ify (3x3 → 9x9 meta-grid)

---

## 2026-02-04 (cont'd): 9x9 Meta-Grid

**Focus:** Expand from 3x3 to 9x9 (3x3 meta-grid of 3x3 sub-boards).

**Completed:**
- `SubBoard` struct with `cells: [[Mark; 3]; 3]` and `outcome: Outcome`
- `Game.boards: [[SubBoard; 3]; 3]` replaces flat `board`
- Nested rendering: `render_board` → `render_sub_board` → `render_cell`
- 4 data attributes per cell (`data-meta-row/col`, `data-row/col`)
- CSS: thick borders (5px) between sub-boards, thin (2px) within, 10px padding

**Decisions:**
- `SubBoard` struct over 4D array — sub-boards need their own `outcome` for meta-game
- `grid-template-columns: auto` over `1fr` — prevents cell gaps when grid expands
- Padding inside sub-boards, not gap between — keeps meta-grid lines touching

**Next:** Sub-board win indicator (visual feedback when a sub-board is won)

---

## 2026-02-04 (cont'd): Sub-board Win Indicator

**Focus:** Visual feedback when a sub-board is won or drawn.

**Completed:**
- `.outcome` element always present in each sub-board (invariant position)
- Absolutely positioned overlay dims the board when resolved
- Wins show large X/O symbol; draws show only the dim
- `data-resolved` attribute controls visibility (`:empty` doesn't work for draw case)

**Decisions:**
- Overlay always exists vs conditional creation — avoids DOM churn on state change
- Named `.outcome` not `.overlay` — name represents what it is, not what it does
- Boolean `data-resolved` attribute vs class — semantic, CSS selector `[data-resolved]`

**Next:** Active sub-board constraint (the defining Super TTT mechanic)
